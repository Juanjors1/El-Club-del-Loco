<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Dados Animados 3D — Tirada con Gráfica</title>
<style>
  :root{
    --bg:#08131f;
    --card:#0b1220;
    --accent:#22c55e;
    --shadow:rgba(0,0,0,.4);
  }
  html,body{height:100%;margin:0;background:radial-gradient(circle at center,var(--bg) 0%,#02040a 100%);font-family:Inter,system-ui,Arial;color:#fff;overflow:hidden;}
  .wrap{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;gap:20px;}
  .scene{width:75vmin;height:75vmin;display:flex;align-items:center;justify-content:center;perspective:1200px;}
  .dice-pair{display:flex;gap:60px;}

  .cube{position:relative;width:120px;height:120px;transform-style:preserve-3d;transition:transform 2s cubic-bezier(.2,.9,.2,1);}
  .face{position:absolute;width:120px;height:120px;background:#fff;border-radius:12px;display:flex;align-items:center;justify-content:center;box-shadow:inset 0 -6px 12px rgba(0,0,0,.15),0 4px 16px var(--shadow);}
  .pip{width:18px;height:18px;background:#111;border-radius:50%;}

  .face:nth-child(1){transform:translateZ(60px);}  /* front */
  .face:nth-child(2){transform:rotateY(180deg) translateZ(60px);} /* back */
  .face:nth-child(3){transform:rotateY(90deg) translateZ(60px);}  /* right */
  .face:nth-child(4){transform:rotateY(-90deg) translateZ(60px);} /* left */
  .face:nth-child(5){transform:rotateX(90deg) translateZ(60px);}  /* top */
  .face:nth-child(6){transform:rotateX(-90deg) translateZ(60px);} /* bottom */

  button{padding:12px 20px;border:0;border-radius:10px;background:linear-gradient(180deg,var(--accent),#15803d);color:#fff;font-size:1.1rem;font-weight:700;cursor:pointer;box-shadow:0 8px 24px rgba(34,197,94,.2);transition:transform .2s;}
  button:hover{transform:scale(1.05);}
  .result{font-size:2rem;font-weight:800;color:var(--accent);text-shadow:0 0 10px rgba(34,197,94,.3);}
  .stats{font-size:.9rem;color:#cbd5e1;max-height:100px;overflow:auto;background:rgba(255,255,255,0.05);padding:8px 12px;border-radius:8px;}
  canvas{background:rgba(255,255,255,0.05);border-radius:10px;box-shadow:0 4px 20px rgba(0,0,0,.4);}
</style>
</head>
<body>
<div class="wrap">
  <div class="scene">
    <div class="dice-pair">
      <div class="cube" id="cube1"></div>
      <div class="cube" id="cube2"></div>
    </div>
  </div>
  <div class="result" id="result">—</div>
  <button id="rollBtn">Tirar dados</button>
  <canvas id="chart" width="400" height="120"></canvas>
  <div class="stats" id="stats">Historial vacío</div>
</div>

<script>
const cube1=document.getElementById('cube1');
const cube2=document.getElementById('cube2');
const rollBtn=document.getElementById('rollBtn');
const result=document.getElementById('result');
const stats=document.getElementById('stats');
const chart=document.getElementById('chart');
const ctx=chart.getContext('2d');

const faces={1:[5],2:[1,9],3:[1,5,9],4:[1,3,7,9],5:[1,3,5,7,9],6:[1,3,4,6,7,9]};
function createCube(cube){
  cube.innerHTML='';
  for(let i=1;i<=6;i++){
    const face=document.createElement('div');
    face.className='face';
    const grid=document.createElement('div');
    grid.style.display='grid';
    grid.style.gridTemplateColumns='repeat(3,1fr)';
    grid.style.gridTemplateRows='repeat(3,1fr)';
    grid.style.width='100%';
    grid.style.height='100%';
    for(let j=1;j<=9;j++){
      const cell=document.createElement('div');
      cell.style.display='flex';
      cell.style.alignItems='center';
      cell.style.justifyContent='center';
      if(faces[i].includes(j)){
        const pip=document.createElement('div');pip.className='pip';cell.appendChild(pip);
      }
      grid.appendChild(cell);
    }
    face.appendChild(grid);
    cube.appendChild(face);
  }
}
createCube(cube1);
createCube(cube2);

let history=[];
let resultsCount=Array(13).fill(0);

function drawChart(){
  ctx.clearRect(0,0,chart.width,chart.height);
  const max=Math.max(...resultsCount.slice(2));
  const barWidth=chart.width/12;
  for(let i=2;i<=12;i++){
    const h=(resultsCount[i]/(max||1))*chart.height*0.8;
    ctx.fillStyle='#22c55e';
    ctx.fillRect((i-2)*barWidth+10,chart.height-h,barWidth-20,h);
    ctx.fillStyle='#94a3b8';
    ctx.font='12px Arial';
    ctx.fillText(i,(i-2)*barWidth+barWidth/2,chart.height-4);
  }
}

function roll(){
  rollBtn.disabled=true;
  const a=Math.floor(Math.random()*6)+1;
  const b=Math.floor(Math.random()*6)+1;
  const dur=1500;

  const rot=(cube)=>{
    const x=Math.floor(Math.random()*24)*15;
    const y=Math.floor(Math.random()*24)*15;
    cube.style.transform=`rotateX(${x}deg) rotateY(${y}deg)`;
  };
  rot(cube1);rot(cube2);

  const audio=new AudioContext();
  const osc=audio.createOscillator();
  const gain=audio.createGain();
  osc.type='triangle';osc.frequency.value=340;gain.gain.value=0.04;
  osc.connect(gain);gain.connect(audio.destination);
  osc.start();
  gain.gain.exponentialRampToValueAtTime(0.0001,audio.currentTime+dur/1000);
  setTimeout(()=>{osc.stop();audio.close();},dur);

  setTimeout(()=>{
    createCube(cube1);
    createCube(cube2);
    cube1.style.transform=`rotateX(${(a-1)*60}deg) rotateY(${(a-1)*45}deg)`;
    cube2.style.transform=`rotateX(${(b-1)*60}deg) rotateY(${(b-1)*45}deg)`;
    const sum=a+b;
    result.textContent=`${a} + ${b} = ${sum}`;
    history.unshift(sum);
    if(history.length>10)history.pop();
    stats.innerHTML='Últimas tiradas: '+history.join(', ');
    resultsCount[sum]++;
    drawChart();
    rollBtn.disabled=false;
  },dur);
}

rollBtn.addEventListener('click',roll);
drawChart();
</script>
</body>
</html>
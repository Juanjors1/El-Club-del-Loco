<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pirinola con menú, efectos y sonido</title>
  <style>
    :root{--size:360px;--accent:#16a34a}
    body{font-family:Inter,system-ui,Arial,sans-serif;margin:0;min-height:100vh;display:flex;align-items:center;justify-content:center;background:radial-gradient(circle at center,#04101e 0%,#010409 100%);color:#fff;overflow:hidden}
    .wrap{width:100%;max-width:920px;padding:28px;text-align:center}
    h1{margin:0 0 14px;font-weight:600;letter-spacing:.3px}

    .board{display:inline-block;background:rgba(255,255,255,0.04);padding:18px;border-radius:18px;box-shadow:0 12px 40px rgba(2,6,23,.6);position:relative;}
    svg{display:block}

    .arrow-group{transition:transform 3.6s cubic-bezier(.2,.9,.2,1);transform-origin:160px 160px}

    .controls{margin-top:18px;display:flex;flex-direction:column;align-items:center;gap:10px}
    button, select{padding:10px 18px;border-radius:10px;border:none;background:linear-gradient(180deg,var(--accent),#0f7a3a);color:white;font-weight:700;cursor:pointer;box-shadow:0 8px 24px rgba(22,163,74,.18);transition:transform .2s}
    button:hover, select:hover{transform:scale(1.05)}
    button:disabled{opacity:.45;cursor:not-allowed;transform:none}

    .result{margin-top:10px;font-weight:700;min-height:28px}
    .history{margin-top:10px;font-size:.9rem;max-height:120px;overflow-y:auto;text-align:left;color:#cbd5e1;background:rgba(255,255,255,0.05);border-radius:8px;padding:6px 12px;width:260px;margin-inline:auto;}

    .light{position:absolute;width:400px;height:400px;border-radius:50%;filter:blur(90px);opacity:.2;z-index:-1;animation:pulse 6s infinite alternate ease-in-out}
    .l1{background:#22c55e;top:-100px;left:-100px}
    .l2{background:#2563eb;bottom:-100px;right:-100px;animation-delay:2s}
    @keyframes pulse{from{opacity:.15;transform:scale(1)}to{opacity:.3;transform:scale(1.1)}}

    .highlight{filter:drop-shadow(0 0 20px rgba(34,197,94,.6));}
    .menu{display:flex;gap:8px;flex-wrap:wrap;justify-content:center;margin-top:10px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="light l1"></div>
    <div class="light l2"></div>
    <h1>Pirinola de 4 caras avanzada</h1>
    <div class="board">
      <svg id="svg" width="320" height="320" viewBox="0 0 320 320">
        <defs>
          <path id="arcTop" d="M160 20 A140 140 0 0 1 300 160" fill="none" />
          <path id="arcRight" d="M300 160 A140 140 0 0 1 160 300" fill="none" />
          <path id="arcBottom" d="M160 300 A140 140 0 0 1 20 160" fill="none" />
          <path id="arcLeft" d="M20 160 A140 140 0 0 1 160 20" fill="none" />
        </defs>

        <path id="sTop" d="M160 160 L160 20 A140 140 0 0 1 300 160 Z" fill="#fde68a" />
        <path id="sRight" d="M160 160 L300 160 A140 140 0 0 1 160 300 Z" fill="#bbf7d0" />
        <path id="sBottom" d="M160 160 L160 300 A140 140 0 0 1 20 160 Z" fill="#c7d2fe" />
        <path id="sLeft" d="M160 160 L20 160 A140 140 0 0 1 160 20 Z" fill="#fecaca" />

        <circle cx="160" cy="160" r="36" fill="rgba(255,255,255,0.06)" />
        <circle cx="160" cy="160" r="22" fill="#071126" stroke="rgba(255,255,255,0.06)" stroke-width="2" />

        <text font-family="Inter,Arial" font-weight="700" font-size="14" fill="#071126">
          <textPath href="#arcTop" startOffset="50%" text-anchor="middle">Toma uno</textPath>
        </text>
        <text font-family="Inter,Arial" font-weight="700" font-size="14" fill="#071126">
          <textPath href="#arcRight" startOffset="50%" text-anchor="middle">Todos toman</textPath>
        </text>
        <text font-family="Inter,Arial" font-weight="700" font-size="14" fill="#071126">
          <textPath href="#arcBottom" startOffset="50%" text-anchor="middle">Todos brincan</textPath>
        </text>
        <text font-family="Inter,Arial" font-weight="700" font-size="14" fill="#071126">
          <textPath href="#arcLeft" startOffset="50%" text-anchor="middle">Pierde un tiro</textPath>
        </text>

        <g id="arrowGroup" class="arrow-group">
          <rect x="156" y="-60" width="8" height="220" rx="4" ry="4" transform="translate(0,80)" fill="#0f6b3a" />
          <polygon points="160,28 148,60 172,60" fill="#16a34a" transform="translate(0,80)" />
          <circle cx="160" cy="160" r="6" fill="#0b4f2c" />
        </g>
      </svg>
    </div>

    <div class="controls">
      <div class="menu">
        <button id="btn">Tirar</button>
        <button id="resetHistorial">Borrar historial</button>
        <label>Velocidad:
          <select id="velocidad">
            <option value="2.8">Rápida</option>
            <option value="3.6" selected>Normal</option>
            <option value="5">Lenta</option>
          </select>
        </label>
      </div>
      <div id="res" class="result">Resultado: —</div>
      <div class="history" id="historial"></div>
    </div>
  </div>

  <audio id="soundSpin" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_6f82d72b1f.mp3?filename=spin-112270.mp3" preload="auto"></audio>
  <audio id="soundStop" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_1b3d2e2d3f.mp3?filename=click-124467.mp3" preload="auto"></audio>

  <script>
    const btn=document.getElementById('btn');
    const res=document.getElementById('res');
    const arrowGroup=document.getElementById('arrowGroup');
    const sectors=[document.getElementById('sTop'),document.getElementById('sRight'),document.getElementById('sBottom'),document.getElementById('sLeft')];
    const opciones=['Toma uno','Todos toman','Todos brincan','Pierde un tiro'];
    const historial=document.getElementById('historial');
    const soundSpin=document.getElementById('soundSpin');
    const soundStop=document.getElementById('soundStop');
    const resetHistorial=document.getElementById('resetHistorial');
    const velocidad=document.getElementById('velocidad');

    let rotActual=0;

    function marcarGanador(ind){
      sectors.forEach(s=>s.classList.remove('highlight'));
      sectors[ind].classList.add('highlight');
    }

    function agregarHistorial(texto){
      const p=document.createElement('div');
      const fecha=new Date().toLocaleTimeString();
      p.textContent=`${fecha}: ${texto}`;
      historial.prepend(p);
    }

    function girar(){
      btn.disabled=true;
      res.textContent='Girando...';
      sectors.forEach(s=>s.classList.remove('highlight'));
      soundSpin.currentTime=0;
      soundSpin.play();

      const extra=Math.floor(Math.random()*360);
      const vueltas=6+Math.floor(Math.random()*6);
      const destino=rotActual+vueltas*360+extra;
      const dur=parseFloat(velocidad.value);
      arrowGroup.style.transition=`transform ${dur}s cubic-bezier(.2,.9,.2,1)`;
      arrowGroup.style.transform=`rotate(${destino}deg)`;

      arrowGroup.addEventListener('transitionend',()=>{
        soundStop.play();
        rotActual=destino%360;
        const sector=Math.floor(((rotActual%360)/90))%4;
        const idx=(4-sector)%4;
        const texto=opciones[idx];
        res.textContent='Resultado: '+texto;
        marcarGanador(idx);
        agregarHistorial(texto);
        arrowGroup.animate([
          {transform:`rotate(${destino}deg)`},
          {transform:`rotate(${destino+6}deg)`},
          {transform:`rotate(${destino-4}deg)`},
          {transform:`rotate(${destino}deg)`}
        ],{duration:600,easing:'ease-out'});
        btn.disabled=false;
      },{once:true});
    }

    btn.addEventListener('click',girar);
    resetHistorial.addEventListener('click',()=>{
      historial.innerHTML='';
      res.textContent='Resultado: —';
    });
  </script>
</body>
</html>